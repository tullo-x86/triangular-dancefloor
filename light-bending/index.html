<!DOCTYPE html>
<html>
    <head>
        <title>Three on the floor</title>
        <link rel="stylesheet" type="text/css" href="dfloor.css" />
        <script src="jquery-2.1.3.min.js"></script>
        <script src="jquery.svg.js"></script>
        <script src="jquery.svgdom.js"></script>
        <script src="triangles.js"></script>
        
        <script type="text/javascript">
            $(function() {
                function HSVtoRGB(h, s, v) {
                    var r, g, b, i, f, p, q, t;
                    if (h && s === undefined && v === undefined) {
                        s = h.s, v = h.v, h = h.h;
                    }
                    i = Math.floor(h * 6);
                    f = h * 6 - i;
                    p = v * (1 - s);
                    q = v * (1 - f * s);
                    t = v * (1 - (1 - f) * s);
                    switch (i % 6) {
                        case 0: r = v, g = t, b = p; break;
                        case 1: r = q, g = v, b = p; break;
                        case 2: r = p, g = v, b = t; break;
                        case 3: r = p, g = q, b = v; break;
                        case 4: r = t, g = p, b = v; break;
                        case 5: r = v, g = p, b = q; break;
                    }
                    return {
                        r: Math.floor(r * 255),
                        g: Math.floor(g * 255),
                        b: Math.floor(b * 255)
                    };
                }

                dancefloor.createRowAt(0, -2, 2);
                dancefloor.createRowAt(1, -8, 8);
                dancefloor.createRowAt(2, -7, 7);
                dancefloor.createRowAt(3, -6, 6);
                dancefloor.createRowAt(4, -6, 6);
                dancefloor.createRowAt(5, -6, 6);
                dancefloor.createRowAt(6, -5, 5);
                dancefloor.createRowAt(7, -2, 2);
                dancefloor.createRowAt(8, -1, 1);
                dancefloor.createRowAt(9, 0, 0);

                var pyramidHeight = 7;
                for (var i = 3; i < pyramidHeight; i++) {
                    $('.r'+ i +'.c'+ (pyramidHeight - i)).addClass('on');
                    $('.r'+ i +'.c'+ (pyramidHeight - i - 1)).addClass('on');
                    $('.r'+ i +'.c'+ -(pyramidHeight - i)).addClass('on');
                    $('.r'+ i +'.c'+ -(pyramidHeight - i - 1)).addClass('on')
                };
                //$('.r'+pyramidHeight+'.c0').addClass('on');
                for (var i = -pyramidHeight + 3; i <= pyramidHeight - 3; i++) {
                    $('.r2.c'+i).addClass('on');
                };

                for (var h = 0; h < 6; h++) {
                    var hue = h / 6;
                    var hueRow = $('<div class="hue-row"></div>');

                    for (var s = 0; s < 4; s++) {
                        var sat = s / 3;
                        var satRow = $('<div class="sat-row"></div>');

                        for (var v = 0; v < 8; v++) {
                            var val = v / 7;
                            var valSwatch = $('<div class="swatch"></div>');

                            var rgb = HSVtoRGB(hue, sat, val);
                            valSwatch.css('background', 'rgb(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ')');
                            satRow.append(valSwatch);
                        };

                        hueRow.append(satRow);
                    };

                    $('#swatches').append(hueRow);
                };
            });
        </script>
        <style type="text/css">
            #swatches {
                border: 1px solid black;
            }
            .hue-row {
                border: 1px solid lime;
            }
            .sat-row {
                border: 1px solid blue;
            }
            .swatch {
                width: 40px;
                height: 40px;
                display: inline-block;
                margin: 10px;
            }
        </style>
    </head>
    <body>
        <!-- root-3 / 2 == 0.866025403784 -->
        <!-- scaled x50 == 43.3012701892 -->
        <h1>Three on the floor - <span id="tricount"></span></h1>
        <svg id="df" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <line x1="50%" y1="0" 
                  x2="50%" y2="100%" 
                  stroke="white" 
                  stroke-width="2"/>
            <line x1="0%" y1="500px" 
                  x2="100%" y2="500px" 
                  stroke="white" 
                  stroke-width="2"/>
            <g id="all">
                <!-- Triangles go here -->
            </g>
        </svg>
        <div id="swatches" style="display:none;"></div>
    </body>
</html>